---
layout: lesson
root: .
title: File Format: FASTQ
minutes: 5
---

## Status & ToDo : Under Development
    
* move the example data from DropBox to Figshare, ...
* add link to FastQC lesson (remark Quality score)

## Learning Objectives 

* Describe the features of a FASTQ file
* Manipulate FASTQ files

## Lesson 

### Example data

An example FASTQ file can be downloaded [here](https://dl.dropboxusercontent.com/u/4121271/DataCarpentry/ERR754084_1.100.fastq) or through 
    
```
wget https://dl.dropboxusercontent.com/u/4121271/DataCarpentry/ERR754084_1.100.fastq
```

This is a subset of 100 records of the FASTQ file from sample Col0_C1 of [this experiment](http://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-3279). This is a dataset of the Arabidopsis thaliana accession Columbia 0 (the reference). The original dataset can be downloaded as follows: ** Be aware this file is large: 1.6 GB! **
    
```
# HUGE FILE
wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR754/ERR754084/ERR754084_1.fastq.gz
```

## Purpose of FASTQ

FASTQ is a multi-fasta-like format which is the standard format generated by (most) next-generation sequencing platforms. This file is generated by the base-calling pipeline of the platform and contains the sequence and a quality score for each base. This is usually the raw input files you obtain from a service provider.

## FASTQ format

Download the example FASTQ file and have a look at the first 4 lines

```
head -n 4 ERR754084_1.100.fastq
```

You should see this:

    @ERR754084.1 HWI-ST486:305:C0RH5ACXX:1:1101:1189:2104/1 
    GGGCAACATCAGAAGAAAACGCAGAGGGACAAATAAGAAAACTATTATTCCCNAAAACGAACCAGTCGACACAACCAAAACCAAAATGAACAAGTCAGAGG
    +
    @@@FDD?DDFFHAGEGG;FHI8HGHHEHE7FEGGGIIGGI9DFFGIIIIGGA#(-5@;@AE8B@A>CCB993<?888<8?BBCBBBCCCA@CCC:@D(4:?

These 4 lines make up a FASTQ record. In a FASTQ file there are usually millions of records. Each record consists of 4 lines:
    
* header for the sequence, always starts with '@'
* sequence
* header for the quality score, always starts with '+'. Often abbreviated to just '+' if it's the same as the sequence header (line 1)
* the quality score for each base of the sequence

### Header

The header contains information on the sequencing machine, flow-cell, lane, etc

For more details: [wikipedia](https://en.wikipedia.org/wiki/FASTQ_format#Illumina_sequence_identifiers)

### Quality Score

The quality score encodes the probability that a base call is wrong. Or in other words, how sure is it that the base correctly called? This is done using a Phred-score

    Phred-score = -10 * log10(p)

| Phred-score | Probability WRONG base call |
|-------------|-------------|
| 10 | 1/10 |
| 20 | 1/100 |
| 30 | 1/1000 |
| 40 | 1/10000 |

The Phred-score ranges from 0 to 93 and uses ASCII 33 to 126 to represent the score. [ASCII](http://www.asciitable.com) provides for each character a number: '!' corresponds to 33 and a Phred Quality of zero and 'A' is ASCII 65 or a Phred score of 32 (65 - 33).

#### Remark

The Quality Score encoding has gone through different versions. The above information is valid for current data, but older data might use a different encoding. You can find detailed information [here](https://en.wikipedia.org/wiki/FASTQ_format#Encoding).

#### Challenge

Have a look at the full [ASCII](http://www.asciitable.com) table. 

* What ASCII number corresponds to '?'
* What is the corresponding Phred Score?
* What is the probability of the base calling being correct?
